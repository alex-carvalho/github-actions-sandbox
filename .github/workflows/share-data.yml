name: Share Variables Between jobs and steps
on:
  workflow_dispatch:

jobs:
  job1:
    runs-on: ubuntu-latest

    outputs:
      foo: ${{ steps.my-step.outputs.foo }}
      bar: ${{ steps.second-step.outputs.bar }}
    steps:
      - name: Generate and export foo
        id: my-step
        run: |
          foo=bar

          # 1) Step output (for job output)
          echo "foo=${foo}" >> "$GITHUB_OUTPUT"

          # 2) Job-scoped environment variable
          echo "FOO=${foo}" >> "$GITHUB_ENV"

      - name: Inspect values inside producer
        id: second-step
        run: |
          echo "FOO (set via GITHUB_ENV):   $FOO"
          echo "foo (step output):          ${{ steps.my-step.outputs.foo }}"
          bar=foo\
          

  job2:
    runs-on: ubuntu-latest
    needs: job1
    steps:
      - name: Inspect values inside consumer (note FOO is unset)
        run: |
          echo "Value from job1 foo:        ${{ needs.job1.outputs.foo }}"
          echo "Value from job1 bar:        ${{ needs.job1.outputs.bar }}"
          echo "FOO in consumer:            ${FOO:-<UNSET>}"